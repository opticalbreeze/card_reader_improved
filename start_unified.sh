#!/bin/bash
# ============================================================================
# カードリーダーシステム 簡単起動スクリプト
# ダブルクリックまたは ./start_unified.sh で実行
# ============================================================================

echo "========================================================================"
echo "  カードリーダーシステム 起動中..."
echo "========================================================================"
echo ""

# スクリプトのディレクトリに移動
cd "$(dirname "$0")"

# 仮想環境が存在するか確認
if [ ! -d "venv" ]; then
    echo "[エラー] 仮想環境が見つかりません"
    echo ""
    echo "セットアップを実行してください:"
    echo "  chmod +x setup.sh"
    echo "  ./setup.sh"
    echo ""
    exit 1
fi

# 仮想環境を有効化
echo "[1/3] 仮想環境を有効化中..."
source venv/bin/activate

# 設定ファイルが存在するか確認
if [ ! -f "client_config.json" ]; then
    echo "[2/3] 設定ファイルが見つかりません"
    echo "       デフォルト設定で起動します（初回起動時に自動作成されます）"
else
    echo "[2/3] 設定ファイル読み込み完了"
fi

# プログラムを起動
echo "[3/3] プログラムを起動します..."
echo ""
python3 client_card_reader_unified_improved.py

# 終了時
echo ""
echo "========================================================================"
echo "プログラムを終了しました"
echo "========================================================================"
echo ""
